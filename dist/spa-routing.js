let root="";function setRoot(t){root=t,syncLinksWithRoutes(document.querySelectorAll("a"),document.querySelectorAll("spa-route"))}window.addEventListener("load",()=>{new MutationObserver(t=>{t.forEach(t=>{[...t.addedNodes,...t.removedNodes].find(t=>"A"==t.tagName)&&syncLinksWithRoutes(document.querySelectorAll("a"),document.querySelectorAll("spa-route"))})}).observe(document.body,{childList:!0,subtree:!0,attributes:!1}),window.dispatchEvent(new PopStateEvent("popstate"))}),window.addEventListener("popstate",t=>{document.querySelectorAll("spa-route[active]").forEach(t=>t.active=!1);var e=window.location.pathname.split("/").slice(1).reduce((t,e)=>[...t,`${t.at(-1)||""}/`+e],[]).map(t=>`spa-route[path='${t}']`).join(", ");document.querySelectorAll(e).forEach(t=>{t.active=!0})});class SpaRoute extends HTMLElement{constructor(){super(),this._path=null,this._active=null,this.ignoreMutations=!1,this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML="<slot></slot>"}static get observedAttributes(){return["path","active"]}set active(t){this.shadowRoot&&(this.ignoreMutations=!0,t?this.setAttribute("active",""):this.removeAttribute("active"),this.ignoreMutations=!1)}get active(){return this._active}set path(t){this.ignoreMutations=!0,this._path=t,this.setAttribute("path",t),this.ignoreMutations=!1}get path(){return this._path}connectedCallback(){syncLinksWithRoutes(document.querySelectorAll("a"),document.querySelectorAll("spa-route"))}disconnectedCallback(){syncLinksWithRoutes(document.querySelectorAll("a"),document.querySelectorAll("spa-route"))}attributeChangedCallback(t,e,o){e===o||this.ignoreMutations||(this[t]=o)}}function syncLinksWithRoutes(t,e){t.forEach(t=>{t.pathname&&!t.pathname.startsWith(root)&&(t.pathname=root+t.pathname)}),e.forEach(t=>{t.path&&!t.path.startsWith(root)&&(t.path=root+t.path)}),t.forEach(t=>{t.origin==window.location.origin&&(routeMatchExists(t.pathname,[...e])?t.addEventListener("click",pushStateOnClick):t.removeEventListener("click",pushStateOnClick))})}function routeMatchExists(e,t){return t.find(t=>t.path==e)}function pushStateOnClick(t){t.preventDefault(),history.pushState(null,null,t.currentTarget.pathname),window.dispatchEvent(new PopStateEvent("popstate"))}window.customElements.define("spa-route",SpaRoute);export{setRoot};